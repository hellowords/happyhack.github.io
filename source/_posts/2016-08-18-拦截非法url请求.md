---
title: 拦截非法url请求
tags:
  - php
id: 136
categories:
  - code
date: 2016-08-18 17:30:55
---

最近发现公司服务器有很多的非法请求，看了下那些url参数，发现大多都是对数据库非法进行操作的一些动作。
写了一段简单的脚本，放在网站入口文件中，让这些非法请求重定向！
<!-- more --> 

```php
$check_url = $_SERVER['REQUEST_URI'];
$url_arr = array(
	'alert',
	'script',
	'body',
	'onload',
	'UNION',
	'iframe',
	'SELECT',
	'CONCAT',
	'ALL',
	'select',
	'del',
	'update'
		);
foreach ($url_arr as $key =&gt; $value) {
	if(strpos($check_url,$value)){
		header('Location: http://www.google.com/');
	}
}
```